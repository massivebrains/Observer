version: '3.8'

services:
  status-monitoring:
    build:
      context: ../../
      dockerfile: ./environments/test/app/Dockerfile
    environment:
      APP_ENV: "test"
      APP_DEBUG: "1"
      APP_KEY: "base64:cKIAHpfPQfioXrZlYegBXiqqc508cK91eF8wnTR7stI="
      DB_DATABASE: "status_monitoring_test"
      XDG_CONFIG_HOME: "/application/.config"
      API_AUTH_TOKEN: "4a63bb7c-1e14-4cf0-ba31-ddcddf79b277"
    depends_on:
      - status-monitoring-mysql

  status-monitoring-mysql:
    image: mysql:8
    command: mysqld --sql_mode=""
    container_name: "status-monitoring-mysql"
    working_dir: /application
    environment:
      MYSQL_ROOT_PASSWORD: ""
      MYSQL_ALLOW_EMPTY_PASSWORD: "yes"
      MYSQL_DATABASE: "status_monitoring_test"
    ports:
      - "3306:3306"


  rabbitmq:
    image: rabbitmq:3.13-alpine
    container_name: 'status-monitoring-rabbitmq'
    ports:
      - 5672:5672
